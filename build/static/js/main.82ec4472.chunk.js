(this["webpackJsonpreads-frontend"]=this["webpackJsonpreads-frontend"]||[]).push([[0],{20:function(e,t,n){e.exports=n(34)},30:function(e){e.exports=JSON.parse('[{"name":"home","location":"/","parent":null},{"name":"search","location":"/etsi","parent":"home"},{"name":"readlists","location":"/list","parent":"home"},{"name":"list details","location":"/list/:id","parent":"readlists"},{"name":"recommendations","location":"/recommendations","parent":"home"}]')},31:function(e,t,n){},32:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(17),i=n.n(o),c=n(1),s=null,l=function(){return fetch("/readlists",{method:"get",headers:{Authorization:s}}).then((function(e){return e.json()}))},u=function(e){return fetch("/readlists",{method:"post",headers:{"Content-Type":"application/json",Authorization:s},body:JSON.stringify(e)}).then((function(e){return e.json()}))},m=function(e){return fetch("/readlists/".concat(e),{method:"get",headers:{Authorization:s}}).then((function(e){return e.json()}))},f=function(e){return fetch("/book/".concat(e)).then((function(e){return e.json()}))},d=function(e){return fetch("/books",{method:"post",headers:{"Content-Type":"application/json",Authorization:s},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){return e}))},b=function(e){return fetch("/recommendations/rate",{method:"post",headers:{"Content-Type":"application/json",Authorization:s},body:JSON.stringify(e)}).then((function(e){return e.json()}))},h=function(){return fetch("/recommendations/sample",{method:"get",headers:{Authorization:s}}).then((function(e){return e.json()}))},p=function(){return fetch("/recommendations/list",{method:"get",headers:{Authorization:s}}).then((function(e){return e.json()}))},E=function(){return fetch("/recommendations/rated",{method:"put",headers:{Authorization:s}})},g=function(e){s="Bearer ".concat(e)},j=function(e){var t=e.split(" ").join("+");return fetch("/library?author=".concat(t)).then((function(e){return e.json()}))},v=n(8),y=function(e){var t=e.book;return r.a.createElement("div",{className:"book-container"},r.a.createElement("img",{src:t.image_url,alt:"cover"}),r.a.createElement("div",{className:"book-info-container"},r.a.createElement("h1",{className:"title"},t.title),r.a.createElement("h2",{className:"author"},t.authors[0]),r.a.createElement("p",null,t.description)))},O=function(e){var t=e.readLists,n=e.selected,a=e.addBookToList;return t.map((function(e){return r.a.createElement("button",{className:(t=e.id,n===t?"btn-listpicker-selected":"btn-listpicker"),key:e.id,onClick:function(){return a(e.id)}},e.name);var t}))},k=function(e){var t=e.library,n=e.book,o=Object(a.useState)(!1),i=Object(c.a)(o,2),s=i[0],l=i[1],u=s?"Hide books":"Show library books from author";return r.a.createElement(r.a.Fragment,null,t.includes(n.title.toUpperCase())?r.a.createElement("p",{className:"in-library"},"In library"):r.a.createElement("p",{className:"not-in-library"},"Not in library"),r.a.createElement("button",{onClick:function(){return l(!s)}},u),s&&t.map((function(e){return r.a.createElement("p",{key:e},e)})))},N=n(11),S=function(e){var t=e.book,n=e.setBook,a=e.readLists,o=e.library;return r.a.createElement(r.a.Fragment,null,a.length>0&&r.a.createElement("div",{className:"book-card-container"},r.a.createElement(y,{book:t}),r.a.createElement("div",{id:"rating-part"},r.a.createElement(N.a,{stop:10,fractions:2,initialRating:t.rated,onChange:function(e){var a=Object(v.a)(Object(v.a)({},t),{},{rated:e});b(a).then((function(e){n(e)}))}})),r.a.createElement(O,{readLists:a,selected:t.readlist_id,addBookToList:function(e){var a=Object(v.a)(Object(v.a)({},t),{},{readlist_id:e});d(a).then((function(e){n(e.result)}))}}),r.a.createElement(k,{library:o,book:t})))},w=n(2),C=function(){var e=Object(w.g)(),t=Object(w.h)(),n=Object(a.useState)(""),o=Object(c.a)(n,2),i=o[0],s=o[1],u=Object(a.useState)(t.state?t.state.book:void 0),m=Object(c.a)(u,2),d=m[0],b=m[1],h=Object(a.useState)([]),p=Object(c.a)(h,2),E=p[0],g=p[1],v=Object(a.useState)([]),y=Object(c.a)(v,2),O=y[0],k=y[1],N=!!t.state;Object(a.useEffect)((function(){var e=!0;return l().then((function(t){e&&g(t)})),function(){e=!1}}),[]),Object(a.useEffect)((function(){if(d){var e=d.authors[0];j(e).then((function(e){var t=Array.from(new Set(e));k(t)}))}}),[d]);return r.a.createElement("div",null,r.a.createElement("h1",{className:"listTitle"},"Find books"),r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),f(i).then((function(t){!function(t){N?b(t):e.push({pathname:"/etsi",state:{book:t}})}(t)}))}},r.a.createElement("input",{id:"search-input",className:"input",placeholder:"search books by isbn",value:i,onChange:function(e){return s(e.target.value)}}),r.a.createElement("button",{id:"search-btn",className:"button",type:"submit"},"search")),function(){if(d)return r.a.createElement(r.a.Fragment,null,d.title?r.a.createElement(S,{book:d,setBook:b,readLists:E,library:O}):r.a.createElement("p",null,"No results found"))}())},A=n(3),F=n(30),T=function(e){for(var t=e.site,n=[],a=F.find((function(e){return e.name===t})),o=function(){var e=a.parent;(a=F.find((function(t){return t.name===e})))&&n.push(a)};a;)o();return r.a.createElement("div",null,n.reverse().map((function(e){return r.a.createElement(A.b,{key:e.name,className:"breadcrumb-link",to:e.location},"".concat(e.name," >>"))}))," ",t)},x=function(){return r.a.createElement("div",{className:"page-container"},r.a.createElement(T,{site:"search"}),r.a.createElement(C,null))},B=function(e){var t=e.listInput,n=e.setListInput,a=e.submitForm;return r.a.createElement("form",{onSubmit:a},r.a.createElement("input",{id:"add-list-input",value:t,onChange:function(e){return n(e.target.value)}}),r.a.createElement("button",{id:"add-list-btn",disabled:0===t.length,type:"submit"},"Add list"))},I=function(e){var t=e.list;return r.a.createElement("div",{className:"readlist-link-box"},r.a.createElement(A.b,{id:"link-to-readlist",className:"readlist-link",to:"/list/".concat(t.id)},t.name))},U=function(){var e=Object(a.useState)([]),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)(""),s=Object(c.a)(i,2),m=s[0],f=s[1],d=Object(a.useState)(!1),b=Object(c.a)(d,2),h=b[0],p=b[1];Object(a.useEffect)((function(){var e=!0;return l().then((function(t){e&&o(t)})),function(){e=!1}}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:"listTitle"},"Booklists"),r.a.createElement("div",{className:"frontpage-app"},n.map((function(e){return r.a.createElement(I,{key:e.id,list:e})})),r.a.createElement("button",{id:"add-list-form-btn",className:"readlist-add-button",onClick:function(){return p(!h)}},"Add a list"),h&&r.a.createElement(B,{listInput:m,setListInput:f,submitForm:function(e){e.preventDefault(),u({name:m}).then((function(e){o(n.concat(e)),f("")})).catch((function(e){return console.log(e)}))}})))},J=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(T,{site:"readlists"}),r.a.createElement(U,null))},L=function(e){var t=e.item;return r.a.createElement("div",{className:"booklist-item-container"},r.a.createElement("h2",{className:"title"},t.title),r.a.createElement("h3",{className:"author"},t.authors[0]),r.a.createElement("p",null,t.description))},R=function(){var e=Object(a.useState)([]),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)([]),s=Object(c.a)(i,2),u=s[0],f=s[1],d=Object(w.i)().id,b=Number(d);Object(a.useEffect)((function(){l().then((function(e){f(e)}))}),[d]),Object(a.useEffect)((function(){m(d).then((function(e){o(e)}))}),[d]);var h=u.find((function(e){return e.id===b}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(T,{site:"list details"}),h&&r.a.createElement("h1",{className:"listTitle"},h.name),n.map((function(e){return r.a.createElement(A.b,{className:"readlist-link-box",key:e.id,to:{pathname:"/book/details",state:{book:e}}},r.a.createElement(L,{key:e.id,item:e}))})))},z=function(e){var t=Object(a.useState)(e.location.state.book),n=Object(c.a)(t,2),o=n[0],i=n[1],s=Object(a.useState)([]),u=Object(c.a)(s,2),m=u[0],f=u[1],d=Object(a.useState)([]),b=Object(c.a)(d,2),h=b[0],p=b[1],E=Object(w.g)();Object(a.useEffect)((function(){l().then((function(e){return f(e)}))}),[]),Object(a.useEffect)((function(){var e=o.authors[0];j(e).then((function(e){var t=Array.from(new Set(e));p(t)}))}),[o]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"button",onClick:function(e){e.preventDefault(),E.goBack()}},"<"),r.a.createElement(S,{book:o,setBook:i,readLists:m,library:h}))},_=function(){var e=Object(a.useState)([]),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)(!1),s=Object(c.a)(i,2),l=s[0],u=s[1];Object(a.useEffect)((function(){h().then((function(e){return o(e)}))}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:"listTitle"},"Rate books"),r.a.createElement("p",null,"Recommendations are based on the books you've rated"),n.length>0?n.map((function(e){return r.a.createElement("div",{id:"rate-book",key:e.title},r.a.createElement(L,{item:e}),r.a.createElement(N.a,{stop:10,fractions:2,initialRating:e.rated,onChange:function(t){return function(e,t){var a=Object(v.a)(Object(v.a)({},e),{},{rated:t});b(a).then((function(e){o(n.map((function(t){return t.readgeekid===a.readgeekid?e:t}))),l||(u(!0),E())}))}(e,t)}}))})):r.a.createElement(r.a.Fragment,null),r.a.createElement(A.b,{to:"/"},r.a.createElement("button",{id:"sample-ready-button",className:"form-button",disabled:!l},"Ready!")))},D=function(e){var t=e.genres,n=e.genre,a=e.setGenre;return t.map((function(e){return r.a.createElement("button",{key:e,className:e===n?"btn-listpicker-selected":"btn-listpicker",onClick:(t=e,function(){a(t===n?null:t)})},e);var t}))},M=function(){var e=Object(a.useState)([]),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)(null),s=Object(c.a)(i,2),l=s[0],u=s[1],m=Array.from(new Set(n.map((function(e){return e.genre})))),f=l?n.filter((function(e){return e.genre===l})):n;Object(a.useEffect)((function(){var e=!0;return p().then((function(t){e&&o(t)})),function(){e=!1}}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(A.b,{to:"/recommendations"},r.a.createElement("h1",{className:"listTitle"},"Recommendations")),r.a.createElement(D,{genres:m,genre:l,setGenre:u}),0===n.length?r.a.createElement("p",null,"processing, wait for a moment"):f.map((function(e){return r.a.createElement(A.b,{className:"readlist-link-box",key:e.isbn,to:{pathname:"/book/details",state:{book:e}}},r.a.createElement(L,{item:e}))})))},K=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(T,{site:"recommendations"}),r.a.createElement(M,null))},H=function(e){var t=e.id,n=e.label,a=e.type,o=e.value,i=e.onChange;return r.a.createElement("div",null,r.a.createElement("div",{className:"form-label"},n),r.a.createElement("input",{className:"form-input",id:t,type:a,value:o,onChange:i}))},W=function(e){return fetch("/user/login",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){if(!e.ok)throw e;return e.json()}))},G=function(e){return fetch("/user/register",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){if(!e.ok)throw e;return e.json()}))},Y=function(e,t){return t.json().then((function(t){e({style:"notification-error",text:t.error})}))},P=function(e){var t=e.notifyUser,n=Object(a.useState)(""),o=Object(c.a)(n,2),i=o[0],s=o[1],l=Object(a.useState)(""),u=Object(c.a)(l,2),m=u[0],f=u[1],d=Object(a.useState)(""),b=Object(c.a)(d,2),h=b[0],p=b[1],E=Object(w.g)();return r.a.createElement("div",{className:"form-container"},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),G({email:i,username:m,password:h}).then((function(e){t({style:"notification-success",text:"user created"}),E.push("/login")})).catch((function(e){Y(t,e)}))}},r.a.createElement(H,{id:"register-email",label:"e-mail",type:"text",value:i,onChange:function(e){return s(e.target.value)}}),r.a.createElement(H,{id:"register-username",label:"username",type:"text",value:m,onChange:function(e){return f(e.target.value)}}),r.a.createElement(H,{id:"register-password",label:"password",type:"password",value:h,onChange:function(e){return p(e.target.value)}}),r.a.createElement("button",{id:"register-button",className:"form-button",type:"submit"},"register")))},X=function(e){var t=e.setUser,n=e.notifyUser,o=Object(a.useState)(""),i=Object(c.a)(o,2),s=i[0],l=i[1],u=Object(a.useState)(""),m=Object(c.a)(u,2),f=m[0],d=m[1],b=Object(w.g)();return r.a.createElement("div",{className:"form-container"},r.a.createElement("form",{className:"form-element",onSubmit:function(e){e.preventDefault(),W({username:s,password:f}).then((function(e){t(e),g(e.token),window.localStorage.setItem("loggedUser",JSON.stringify(e));var n=e.taste_tested?"/":"/rate";b.push(n)})).catch((function(e){Y(n,e)}))}},r.a.createElement(H,{id:"login-username",label:"username",type:"text",value:s,onChange:function(e){return l(e.target.value)}}),r.a.createElement(H,{id:"login-password",label:"password",type:"password",value:f,onChange:function(e){return d(e.target.value)}}),r.a.createElement("button",{id:"login-button",className:"form-button",type:"submit"},"kirjaudu")),r.a.createElement(A.b,{id:"link-to-register",to:"/register"},"register"))},q=n(19),Q=function(e){var t=e.component,n=e.path,a=e.isAuth,o=Object(q.a)(e,["component","path","isAuth"]);return r.a.createElement(w.b,{path:n},a?r.a.createElement(t,o):r.a.createElement(w.a,{to:"/login"}))},V=function(e){var t=e.message;return r.a.createElement("div",{className:"notification-container"},t&&r.a.createElement("p",{className:t.style},t.text))},Z=function(){return r.a.createElement("p",{className:"footer"},"Powered by ",r.a.createElement("a",{href:"https://www.readgeek.com/"},"Readgeek"),", ",r.a.createElement("a",{href:"https://openlibrary.org/"},"Open Library")," and ",r.a.createElement("a",{href:"https://www.finna.fi/"},"Finna"))},$=(n(31),function(){var e=Object(a.useState)(null),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)(null),s=Object(c.a)(i,2),l=s[0],u=s[1],m=function(e){u(e),setTimeout((function(){u(null)}),5e3)};Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedUser");if(e){var t=JSON.parse(e);o(t),g(t.token)}}),[]);return r.a.createElement("div",{className:"page-container"},n&&r.a.createElement("p",{className:"loggedin-user"},"".concat(n.username," logged in"),r.a.createElement("button",{className:"button",onClick:function(){window.localStorage.removeItem("loggedUser"),o(null),g(null)}},"logout")),r.a.createElement(V,{message:l}),r.a.createElement(A.a,null,r.a.createElement(w.d,null,r.a.createElement(Q,{component:R,path:"/list/:id",isAuth:!!n}),r.a.createElement(Q,{component:J,path:"/list",isAuth:!!n}),r.a.createElement(Q,{component:x,path:"/etsi",isAuth:!!n}),r.a.createElement(Q,{component:z,path:"/book/details",isAuth:!!n}),r.a.createElement(Q,{component:_,path:"/rate",isAuth:!!n}),r.a.createElement(Q,{component:K,path:"/recommendations",isAuth:!!n}),r.a.createElement(w.b,{path:"/register"},r.a.createElement(P,{notifyUser:m})),r.a.createElement(w.b,{path:"/"},n?r.a.createElement(r.a.Fragment,null,r.a.createElement(C,null),r.a.createElement(U,null),r.a.createElement(M,null)):r.a.createElement(X,{setUser:o,notifyUser:m})))),r.a.createElement(Z,null))});n(32),n(33);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement($,{books:[{isbn:"0060512148",isbn13:"9780060512149",title:"Angels",authors:["Marian Keyes"],image:"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1407711412l/82747._SX98_.jpg",description:"Maggie has always been the white sheep of the Walsh family.Unlike her comically dysfunctional sisters,Rachel(heroine of Rachel's Holiday) and Claire (heroine of Watermelon), she married a decent man who adored her and found herself a solid career. Where Rachel was reckless and Claire dramatic, Maggie settled early for safety. Or so she believed until she discovers that her husband is having an affair and her boss is going to fire her. Suddenly, her perfectly organized life has become a perfect mess."},{isbn:"0440241901",isbn13:"9780440241904",title:"Can You Keep a Secret?",authors:["Sophie Kinsella"],image:"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1330464293l/33724._SY160_.jpg",description:"Meet Emma Corrigan, a young woman with a huge heart, an irrepressible spirit, and a few little secrets: Secrets from her boyfriend: I've always thought Connor looks a bit like Ken. As in Barbie and Ken. Secrets from her mother: I lost my virginity in the spare bedroom with Danny Nussbaum while Mum and Dad were downstairs watching Ben-Hur"}]})),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.82ec4472.chunk.js.map