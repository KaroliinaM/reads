(this["webpackJsonpreads-frontend"]=this["webpackJsonpreads-frontend"]||[]).push([[0],{20:function(e,t,n){e.exports=n(34)},30:function(e){e.exports=JSON.parse('[{"name":"home","location":"/","parent":null},{"name":"search","location":"/etsi","parent":"home"},{"name":"readlists","location":"/list","parent":"home"},{"name":"list details","location":"/list/:id","parent":"readlists"},{"name":"recommendations","location":"/recommendations","parent":"home"}]')},31:function(e,t,n){},32:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(17),i=n.n(o),c=n(1),s=n(8),l=function(e){var t=e.book;return r.a.createElement("div",{className:"book-container"},r.a.createElement("img",{src:t.image_url,alt:"cover"}),r.a.createElement("div",{className:"book-info-container"},r.a.createElement("h1",{className:"title"},t.title),r.a.createElement("h2",{className:"author"},t.authors[0]),r.a.createElement("p",null,t.description)))},u=function(e){var t=e.readLists,n=e.selected,a=e.addBookToList;return t.map((function(e){return r.a.createElement("button",{className:(t=e.id,n===t?"btn-listpicker-selected":"btn-listpicker"),key:e.id,onClick:function(){return a(e.id)}},e.name);var t}))},m=null,d=function(){return fetch("/readlists",{method:"get",headers:{Authorization:m}}).then((function(e){return e.json()}))},f=function(e){return fetch("/readlists",{method:"post",headers:{"Content-Type":"application/json",Authorization:m},body:JSON.stringify(e)}).then((function(e){return e.json()}))},b=function(e){return fetch("/readlists/".concat(e),{method:"get",headers:{Authorization:m}}).then((function(e){return e.json()}))},h=function(e){return fetch("/book/".concat(e)).then((function(e){return e.json()}))},p=function(e){return fetch("/books",{method:"post",headers:{"Content-Type":"application/json",Authorization:m},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){console.log("success",e)}))},g=function(e){return fetch("/recommendations/rate",{method:"post",headers:{"Content-Type":"application/json",Authorization:m},body:JSON.stringify(e)}).then((function(e){return e.json()}))},E=function(){return fetch("/recommendations/sample",{method:"get",headers:{Authorization:m}}).then((function(e){return e.json()}))},j=function(){return fetch("/recommendations/list",{method:"get",headers:{Authorization:m}}).then((function(e){return e.json()}))},v=function(){return fetch("/recommendations/rated",{method:"put",headers:{Authorization:m}})},O=function(e){m="Bearer ".concat(e)},y=n(10),k=n(2),N=function(){var e=Object(k.g)(),t=Object(k.h)(),n=Object(a.useState)(""),o=Object(c.a)(n,2),i=o[0],m=o[1],f=Object(a.useState)(t.state?t.state.book:void 0),b=Object(c.a)(f,2),E=b[0],j=b[1],v=Object(a.useState)([]),O=Object(c.a)(v,2),N=O[0],S=O[1],w=!!t.state;Object(a.useEffect)((function(){d().then((function(e){return S(e)}))}),[]);var C=function(e){var t={title:E.title,isbn:E.isbn,image_url:E.image_url,description:E.description,authors:E.authors,readlist_id:e};p(t).then((function(t){var n=Object(s.a)(Object(s.a)({},E),{},{readlist_id:e});j(n)}))},A=function(e){var t={title:E.title,isbn:E.isbn,image_url:E.image_url,description:E.description,authors:E.authors,rated:e};g(t).then((function(e){return console.log(e)}))};return r.a.createElement("div",null,r.a.createElement("h1",{className:"listTitle"},"Find books"),r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),h(i).then((function(t){!function(t){w?j(t):e.push({pathname:"/etsi",state:{book:t}})}(t)}))}},r.a.createElement("input",{id:"search-input",className:"input",value:i,onChange:function(e){return m(e.target.value)}}),r.a.createElement("button",{id:"search-btn",className:"button",type:"submit"},"search")),console.log("bookbyisbn",E),function(){if(E)return r.a.createElement(r.a.Fragment,null,E.title?r.a.createElement("div",{className:"book-card-container"},r.a.createElement(l,{book:E}),r.a.createElement("div",{id:"rating-part"},r.a.createElement(y.a,{stop:10,fractions:2,onChange:A})),r.a.createElement(u,{readLists:N,selected:E.readlist_id,addBookToList:C})):r.a.createElement("p",null,"No results found"))}())},S=n(3),w=n(30),C=function(e){for(var t=e.site,n=[],a=w.find((function(e){return e.name===t})),o=function(){var e=a.parent;(a=w.find((function(t){return t.name===e})))&&n.push(a)};a;)o();return r.a.createElement("div",null,n.reverse().map((function(e){return r.a.createElement(S.b,{className:"breadcrumb-link",to:e.location},"".concat(e.name," >>"))}))," ",t)},A=function(){return r.a.createElement("div",{className:"page-container"},r.a.createElement(C,{site:"search"}),r.a.createElement(N,null))},_=function(e){var t=e.listInput,n=e.setListInput,a=e.submitForm;return r.a.createElement("form",{onSubmit:a},r.a.createElement("input",{id:"add-list-input",value:t,onChange:function(e){return n(e.target.value)}}),r.a.createElement("button",{id:"add-list-btn",type:"submit"},"Add list"))},F=function(e){var t=e.list;return r.a.createElement("div",{className:"readlist-link-box"},r.a.createElement(S.b,{id:"link-to-readlist",className:"readlist-link",to:"/list/".concat(t.id)},t.name))},T=function(){var e=Object(a.useState)([]),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)(""),s=Object(c.a)(i,2),l=s[0],u=s[1],m=Object(a.useState)(!1),b=Object(c.a)(m,2),h=b[0],p=b[1];Object(a.useEffect)((function(){d().then((function(e){return o(e)}))}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:"listTitle"},"Booklists"),r.a.createElement("div",{className:"frontpage-app"},n.map((function(e){return r.a.createElement(F,{key:e.id,list:e})})),r.a.createElement("button",{id:"add-list-form-btn",className:"readlist-add-button",onClick:function(){return p(!h)}},"Add a list"),h&&r.a.createElement(_,{listInput:l,setListInput:u,submitForm:function(e){e.preventDefault(),f({name:l}).then((function(e){o(n.concat(e)),u("")})).catch((function(e){return console.log(e)}))}})))},x=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(C,{site:"readlists"}),r.a.createElement(T,null))},I=function(e){var t=e.item;return r.a.createElement("div",{className:"booklist-item-container"},r.a.createElement("h2",{className:"title"},t.title),r.a.createElement("h3",{className:"author"},t.authors[0]),r.a.createElement("p",null,t.description))},U=function(){var e=Object(a.useState)([]),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)([]),s=Object(c.a)(i,2),l=s[0],u=s[1],m=Object(k.i)().id,f=Number(m);Object(a.useEffect)((function(){d().then((function(e){u(e)}))}),[m]),Object(a.useEffect)((function(){b(m).then((function(e){o(e)}))}),[m]);var h=l.find((function(e){return e.id===f}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(C,{site:"list details"}),h&&r.a.createElement("h1",{className:"listTitle"},h.name),n.map((function(e){return r.a.createElement(S.b,{className:"readlist-link-box",key:e.id,to:{pathname:"/book/details",state:{book:e}}},r.a.createElement(I,{key:e.id,item:e}))})))},J=function(e){var t=e.library,n=e.book,o=Object(a.useState)(!1),i=Object(c.a)(o,2),s=i[0],l=i[1],u=s?"Hide books":"Show library books from author";return r.a.createElement(r.a.Fragment,null,t.includes(n.title.toUpperCase())?r.a.createElement("p",{className:"in-library"},"In library"):r.a.createElement("p",{className:"not-in-library"},"Not in library"),r.a.createElement("button",{onClick:function(){return l(!s)}},u),s&&t.map((function(e){return r.a.createElement("p",{key:e},e)})))},z=function(e){var t=Object(a.useState)(e.location.state.book),n=Object(c.a)(t,2),o=n[0],i=n[1],m=Object(a.useState)([]),f=Object(c.a)(m,2),b=f[0],h=f[1],E=Object(a.useState)([]),j=Object(c.a)(E,2),v=j[0],O=j[1],N=Object(k.g)();Object(a.useEffect)((function(){d().then((function(e){return h(e)}))}),[]),Object(a.useEffect)((function(){var e=o.authors[0].split(" ").join("+");fetch("/library?author=".concat(e)).then((function(e){return e.json()})).then((function(e){var t=Array.from(new Set(e));O(t)}))}),[o]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"button",onClick:function(e){e.preventDefault(),N.goBack()}},"<"),b.length>0&&r.a.createElement("div",{className:"book-card-container"},r.a.createElement(l,{book:o}),r.a.createElement("div",{id:"rating-part"},r.a.createElement(y.a,{stop:10,fractions:2,initialRating:o.rated,onChange:function(e){console.log(e);var t=Object(s.a)(Object(s.a)({},o),{},{rated:e});g(t).then((function(e){return console.log(e)}))}})),r.a.createElement(u,{readLists:b,selected:o.readlist_id,addBookToList:function(e){var t=Object(s.a)(Object(s.a)({},o),{},{readlist_id:e});p(t).then((function(e){i(t)}))}}),r.a.createElement(J,{library:v,book:o})))},B=function(){var e=Object(a.useState)([]),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)(!1),l=Object(c.a)(i,2),u=l[0],m=l[1];Object(a.useEffect)((function(){E().then((function(e){return o(e)}))}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:"listTitle"},"Rate books"),r.a.createElement("p",null,"Recommendations are based on the books you've rated"),n.length>0?n.map((function(e){return r.a.createElement("div",{id:"rate-book",key:e.title},r.a.createElement(I,{item:e}),r.a.createElement(y.a,{stop:10,fractions:2,initialRating:e.rated,onChange:function(t){return function(e,t){var a=Object(s.a)(Object(s.a)({},e),{},{rated:t});g(a).then((function(e){o(n.map((function(e){return e.readgeekid===a.readgeekid?a:e}))),u||(m(!0),v())}))}(e,t)}}))})):r.a.createElement(r.a.Fragment,null),r.a.createElement(S.b,{to:"/"},r.a.createElement("button",{id:"sample-ready-button",className:"form-button",disabled:!u},"Ready!")))},R=function(e){var t=e.genres,n=e.genre,a=e.setGenre;return t.map((function(e){return r.a.createElement("button",{key:e,className:e===n?"btn-listpicker-selected":"btn-listpicker",onClick:(t=e,function(){a(t===n?null:t)})},e);var t}))},L=function(){var e=Object(a.useState)([]),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)(null),s=Object(c.a)(i,2),l=s[0],u=s[1],m=Array.from(new Set(n.map((function(e){return e.genre})))),d=l?n.filter((function(e){return e.genre===l})):n;Object(a.useEffect)((function(){j().then((function(e){return o(e)}))}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(S.b,{to:"/recommendations"},r.a.createElement("h1",{className:"listTitle"},"Recommendations")),r.a.createElement(R,{genres:m,genre:l,setGenre:u}),console.log("genre",l),d.map((function(e){return r.a.createElement(S.b,{className:"readlist-link-box",key:e.isbn,to:{pathname:"/book/details",state:{book:e}}},r.a.createElement(I,{item:e}))})))},D=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(C,{site:"recommendations"}),r.a.createElement(L,null))},M=function(e){var t=e.id,n=e.label,a=e.type,o=e.value,i=e.onChange;return r.a.createElement("div",null,r.a.createElement("div",{className:"form-label"},n),r.a.createElement("input",{className:"form-input",id:t,type:a,value:o,onChange:i}))},K=function(e){var t=e.notifyUser,n=Object(a.useState)(""),o=Object(c.a)(n,2),i=o[0],s=o[1],l=Object(a.useState)(""),u=Object(c.a)(l,2),m=u[0],d=u[1],f=Object(a.useState)(""),b=Object(c.a)(f,2),h=b[0],p=b[1],g=Object(k.g)();return r.a.createElement("div",{className:"form-container"},r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var n,a={email:i,username:m,password:h};fetch("/user/register",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){return n=e,e.json()})).then((function(e){console.log("result",e),n.ok?(t({style:"notification-success",text:"user created"}),g.push("/login")):t({style:"notification-error",text:e})}))}},r.a.createElement(M,{id:"register-email",label:"e-mail",type:"text",value:i,onChange:function(e){return s(e.target.value)}}),r.a.createElement(M,{id:"register-username",label:"username",type:"text",value:m,onChange:function(e){return d(e.target.value)}}),r.a.createElement(M,{id:"register-password",label:"password",type:"password",value:h,onChange:function(e){return p(e.target.value)}}),r.a.createElement("button",{id:"register-button",className:"form-button",type:"submit"},"register")))},H=function(e){var t=e.setUser,n=e.notifyUser,o=Object(a.useState)(""),i=Object(c.a)(o,2),s=i[0],l=i[1],u=Object(a.useState)(""),m=Object(c.a)(u,2),d=m[0],f=m[1],b=Object(k.g)();return r.a.createElement("div",{className:"form-container"},r.a.createElement("form",{className:"form-element",onSubmit:function(e){e.preventDefault();var a={username:s,password:d};fetch("/user/login",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(e){t(e),O(e.token),window.localStorage.setItem("loggedUser",JSON.stringify(e));var n=e.taste_tested?"/":"/rate";b.push(n)})).catch((function(e){401===e.status?(n({style:"notification-error",text:"login failed"}),l(""),f("")):n({style:"notification-error",text:"system error"})}))}},r.a.createElement(M,{id:"login-username",label:"username",type:"text",value:s,onChange:function(e){return l(e.target.value)}}),r.a.createElement(M,{id:"login-password",label:"password",type:"password",value:d,onChange:function(e){return f(e.target.value)}}),r.a.createElement("button",{id:"login-button",className:"form-button",type:"submit"},"kirjaudu")),r.a.createElement(S.b,{id:"link-to-register",to:"/register"},"register"))},W=n(19),G=function(e){var t=e.component,n=e.path,a=e.isAuth,o=Object(W.a)(e,["component","path","isAuth"]);return r.a.createElement(k.b,{path:n},a?r.a.createElement(t,o):r.a.createElement(k.a,{to:"/login"}))},Y=function(e){var t=e.message;return r.a.createElement("div",{className:"notification-container"},t&&r.a.createElement("p",{className:t.style},t.text))},X=(n(31),function(){var e=Object(a.useState)(null),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)(null),s=Object(c.a)(i,2),l=s[0],u=s[1],m=function(e){u(e),setTimeout((function(){u(null)}),5e3)};Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedUser");if(e){var t=JSON.parse(e);o(t),O(t.token)}}),[]);return r.a.createElement("div",{className:"page-container"},n&&r.a.createElement("p",{className:"loggedin-user"},"".concat(n.username," logged in"),r.a.createElement("button",{className:"button",onClick:function(){window.localStorage.removeItem("loggedUser"),o(null),O(null)}},"logout")),r.a.createElement(Y,{message:l}),r.a.createElement(S.a,null,r.a.createElement(k.d,null,r.a.createElement(G,{component:U,path:"/list/:id",isAuth:!!n}),r.a.createElement(G,{component:x,path:"/list",isAuth:!!n}),r.a.createElement(G,{component:A,path:"/etsi",isAuth:!!n}),r.a.createElement(G,{component:z,path:"/book/details",isAuth:!!n}),r.a.createElement(G,{component:B,path:"/rate",isAuth:!!n}),r.a.createElement(G,{component:D,path:"/recommendations",isAuth:!!n}),r.a.createElement(k.b,{path:"/register"},r.a.createElement(K,{notifyUser:m})),r.a.createElement(k.b,{path:"/"},n?r.a.createElement(r.a.Fragment,null,r.a.createElement(N,null),r.a.createElement(T,null),r.a.createElement(L,null)):r.a.createElement(H,{setUser:o,notifyUser:m})))))});n(32),n(33);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(X,{books:[{isbn:"0060512148",isbn13:"9780060512149",title:"Angels",authors:["Marian Keyes"],image:"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1407711412l/82747._SX98_.jpg",description:"Maggie has always been the white sheep of the Walsh family.Unlike her comically dysfunctional sisters,Rachel(heroine of Rachel's Holiday) and Claire (heroine of Watermelon), she married a decent man who adored her and found herself a solid career. Where Rachel was reckless and Claire dramatic, Maggie settled early for safety. Or so she believed until she discovers that her husband is having an affair and her boss is going to fire her. Suddenly, her perfectly organized life has become a perfect mess."},{isbn:"0440241901",isbn13:"9780440241904",title:"Can You Keep a Secret?",authors:["Sophie Kinsella"],image:"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1330464293l/33724._SY160_.jpg",description:"Meet Emma Corrigan, a young woman with a huge heart, an irrepressible spirit, and a few little secrets: Secrets from her boyfriend: I've always thought Connor looks a bit like Ken. As in Barbie and Ken. Secrets from her mother: I lost my virginity in the spare bedroom with Danny Nussbaum while Mum and Dad were downstairs watching Ben-Hur"}]})),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.6e9c2366.chunk.js.map